(this.webpackJsonplmc=this.webpackJsonplmc||[]).push([[0],{15:function(e,t,r){},16:function(e,t,r){},20:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(8),o=r.n(c),i=(r(15),r(7)),l=r(3),s=(r(16),r(10)),u=r(9),A=["LDA","STA","LOA","ADD","SUB","INP","OUT","OTC","HLT","BRZ","BRP","BRA","DAT"],O=["INP","OUT","OTC","HLT"],T={INP:901,OUT:902,OTC:912,HLT:0},m={LDA:"5",STA:"3",LOA:"4",ADD:"1",SUB:"2",BRZ:"7",BRP:"8",BRA:"6",DAT:""},p=function(e){for(var t=new Array(100).fill(0),r=e.split(/\r?\n/).filter((function(e){return 0!==e.length})).map((function(e,t){return e.replace(/\/\/.*?$/,"").split(/\s+/).filter((function(e){return 0!==e.length})).map((function(e){return function(e,t){return isNaN(e)||parseInt(e)!==parseFloat(e)?A.includes(e)?{type:"instruction",value:e,line:t}:e.match(/^[A-Z][A-Z0-9]*$/)?{type:"label",value:e,line:t}:{type:"invalid",value:e,line:t}:{type:"int",value:parseInt(e),line:t}}(e.toUpperCase(),t+1)}))})).filter((function(e){return 0!==e.length})),n={},a=0,c=0;c<r.length;c++){var o=r[c];"label"===o[0].type&&(n[o[0].value]=a,r[c]=o=o.slice(1)),a+=o.filter((function(e){return"instruction"===e.type})).length}var i,l=(r=r.filter((function(e){return 0!==e.length}))).flat(),s=Object(u.a)(l);try{for(s.s();!(i=s.n()).done;){var p=i.value;if("invalid"===p.type)return{memory:new Array(100).fill(0),error:"Unexpected token ".concat(p.value),errorLoc:p}}}catch(S){s.e(S)}finally{s.f()}for(var b=0,d=0;d<l.length;d++){var h=l[d];if("instruction"!==h.type)return{memory:new Array(100).fill(0),error:"Expected instruction, got ".concat(h.value),errorLoc:h};var j=h.value;if(O.includes(j))t[b]=T[j],b++;else{var f=m[j],g=l[d+1],D=f;if("int"===g.type)"DAT"===j?D=g.value.toString():D+=g.value.toString().padStart(2,"0");else{if("label"!==g.type)return{memory:new Array(100).fill(0),error:"Expected value, got ".concat(g.value),errorLoc:h};if(!(g.value in n))return{memory:new Array(100).fill(0),error:"Label ".concat(g.value," is not bound"),errorLoc:h};"DAT"===j?D=n[g.value].toString():D+=n[g.value].toString().padStart(2,"0")}if(D.length>3)return{memory:new Array(100).fill(0),error:"Values cannot exceed 3 digits (got ".concat(D,")"),errorLoc:h};t[b]=parseInt(D),b++,d++}if(b>99)return{memory:new Array(100).fill(0),error:"Exceeded memory capacity of 100 @ ".concat(h.value),errorLoc:h}}return{memory:t,error:null,errorLoc:null}},b=function(e,t,r,n,a,c){r.pc=t;var o=e[r.pc++].toString().padStart(3,"0"),i=parseInt(o[0]),l=10*parseInt(o[1])+parseInt(o[2]);r.ir=i,r.ar=l;var s=!1,u=!1;switch(a&&c&&(r.ac=parseInt(c)),i){case 0:s=!0;break;case 1:r.ac=r.ac+e[l];break;case 2:r.ac=r.ac-e[l];break;case 3:e[l]=r.ac;break;case 4:var A=r.ac,O=l+A>=100?99:l+A;r.ac=e[O];break;case 5:r.ac=e[l];break;case 6:r.pc=l;break;case 7:0===r.ac&&(r.pc=l);break;case 8:r.ac>=0&&(r.pc=l);break;case 9:1===l?u=!0:2===l?n+=r.ac+" ":12===l&&(n+=String.fromCharCode(r.ac))}return{memory:e,ip:r.pc,registers:r,output:n,halt:s,waitingForInput:u}},d={defaultToken:"",keywords:["LDA","STA","LOA","ADD","SUB","INP","OUT","OTC","HLT","BRZ","BRP","BRA","DAT"],tokenizer:{root:[{include:"@whitespace"},[/[a-zA-Z][a-zA-Z0-9]*/,{cases:{"@keywords":"keyword","@default":"type.identifier"}}],[/\d+/,"number"]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\/.*$/,"comment"]]}},h={comments:{lineComment:"//"}},j={Addition:["// Input two numbers, sum them, and output the result","        INP","        STA FIRST","        INP","        ADD FIRST","        OUT","        HLT","FIRST   DAT 0"].join("\n"),"0..N":["// Implements printing 0..N (inc. exc.)","// Similar to for(int i = 0; i < N; i++) or for i in range(N)","// in high-level languages","        INP","        STA EVAL","","// Compare SVAL and EVAL, and if SVAL is equal to or greater than EVAL,","// Jump to END","TOP     LDA SVAL","        SUB EVAL","        BRP END","","// Output SVAL and increment it by one, looping back to TOP","        LDA SVAL","        OUT","        ADD ONE","        STA SVAL","        BRA TOP","","END     HLT","","// Variables: Start Value and End Value","SVAL    DAT 0","EVAL    DAT 0","// Constant 1","ONE     DAT 1"].join("\n"),Max:["// Implements max(a, b) -> returns the higher value of the two.","        INP","        STA FIRST","        INP","        STA SECOND","// Subtract second - first, and if positive second must be greater","        SUB FIRST","        BRP GREATER","// Otherwise, output first and skip over printing second","        LDA FIRST","        OUT","        BRA END","","// Output second","GREATER LDA SECOND","        OUT","","END     HLT","","// Variables","FIRST   DAT 0","SECOND  DAT 0"].join("\n"),Divide:["// Input two values","      INP","      STA VAL1","      INP","      STA VAL2","      ","// Loop, subtracting the val2 and counting iterations","","LOOP  LDA VAL1","      SUB VAL2","// Stop looping when the subtraction result is negative","      BRP BODY","      BRA DONE","","BODY  STA VAL1","      LDA COUNT","      ADD ONE","      STA COUNT","      BRA LOOP","","// After looping, print the count and the remainder (left in val1)","DONE  LDA COUNT","      OUT","      LDA VAL1","      BRZ END","      OUT","END   HLT","","// Variables","VAL1  DAT 0","VAL2  DAT 0","COUNT DAT 0","// Constant 1","ONE   DAT 1"].join("\n"),ASCII:["// Loop through and print all printable ASCII characters","// Similar to 0..N example, but from 33..127","","// Compare FPRINT and LPRINT, branch to end if FPRINT is greater or equal","TOP     LDA FPRINT","        SUB LPRINT","        BRP END","","// Print character from ASCII code","        LDA FPRINT","        OTC","// Increment FPRINT and loop","        ADD ONE","        STA FPRINT","        BRA TOP","","END     HLT","","// Variable FPRINT counts starting from 33","FPRINT  DAT 33","// Constant LPRINT is the last printable character + 1","LPRINT  DAT 127","// Constant 1","ONE     DAT 1"].join("\n"),"Hello World":['// Prints the string "Hello, World!" to the output',"// Loop, checking if the OFFSET is less than LENGTH","BEGIN   LDA LENGTH","        SUB OFFSET","        BRZ END","        BRP PRINT","        BRA END","","// Offset from START by OFFSET to extract the character","// The same as START[OFFSET] in high-level languages","PRINT   LDA OFFSET","// LOA = Load Offset To Accumulator","        LOA START","// OTC = Output accumulator as character (e.g. 65 -> A)","        OTC","        LDA OFFSET","        ADD ONE","        STA OFFSET","        BRA BEGIN","","END     HLT","","// Variable","OFFSET  DAT 0",'// Constant: Encode "Hello, World!" as character codes, one byte after the other',"START   DAT 72","        DAT 101","        DAT 108","        DAT 108","        DAT 111","        DAT 44","        DAT 32","        DAT 87","        DAT 111","        DAT 114","        DAT 108","        DAT 100","        DAT 33","// Constant length of the string","LENGTH  DAT 13","// Constant 1","ONE     DAT 1"].join("\n")},f=r(2),g=["// Input two numbers, sum them, and output the result","        INP","        STA FIRST","        INP","        ADD FIRST","        OUT","        HLT","FIRST   DAT 0"].join("\n"),D=function(e){e.languages.getLanguages().some((function(e){return"lmc"===e.id}))||(e.languages.register({id:"lmc"}),e.languages.setMonarchTokensProvider("lmc",d),e.languages.setLanguageConfiguration("lmc",h))};var S=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(Array(100).fill(0)),r=Object(l.a)(t,2),a=r[0],c=r[1],o=Object(n.useState)(0),u=Object(l.a)(o,2),A=u[0],O=u[1],T=Object(n.useState)({pc:0,ir:0,ar:0,ac:0}),m=Object(l.a)(T,2),d=m[0],h=m[1],S=Object(n.useState)(""),N=Object(l.a)(S,2),v=N[0],L=N[1],I=Object(n.useState)(""),R=Object(l.a)(I,2),E=R[0],y=R[1],x=Object(n.useState)(""),P=Object(l.a)(x,2),F=P[0],C=P[1],B=Object(n.useState)(!1),V=Object(l.a)(B,2),w=V[0],k=V[1],U=Object(n.useState)(!1),H=Object(l.a)(U,2),Z=H[0],M=H[1],G=Object(n.useState)([]),z=Object(l.a)(G,2),W=z[0],J=z[1],$=Object(n.useState)(!1),q=Object(l.a)($,2),Y=q[0],K=q[1],Q=Object(n.useState)("60"),X=Object(l.a)(Q,2),_=X[0],ee=X[1],te=Object(n.useState)(60),re=Object(l.a)(te,2),ne=re[0],ae=re[1],ce=Object(n.useRef)(null),oe=Object(n.useRef)(null),ie=function(e,t){return e?t?"red-border":"green-border":""},le=function(){clearInterval(oe.current)};return Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)("h1",{className:"title",children:"Little Man Computer"}),Object(f.jsxs)("div",{className:"buttons",children:[Object(f.jsx)("button",{onClick:function(){le(),function(){var t=p(e.current.getValue());t.error?y("[".concat(t.errorLoc.line,"]: ").concat(t.error)):(c(t.memory),y(""))}(),O(0),h({pc:0,ir:0,ar:0,ac:0}),L(""),k(!1),M(!1),J([]),K(!1)},children:"Assemble To RAM (reset)"}),Object(f.jsx)("button",{onClick:function(){if(""===E){var e=a,t=0,r={pc:0,ir:0,ar:0,ac:0},n=!1,o="",l=!1;oe.current=setInterval((function(){if(!l||ce.current){var a=Object(i.a)(e),s=r.ac,u=b(e,t,r,o,l,ce.current);e=u.memory,t=u.ip,r=u.registers,n=u.halt,o=u.output,l=u.waitingForInput,ce.current&&(ce.current=null),(n||t>=100)&&(clearInterval(oe.current),oe.current=null),t>=100&&(t=99),O(t),h(r),c(e),L(o),k(l),M(n);for(var A=[],T=0;T<e.length;T++)a[T]!==e[T]&&A.push(T);J(A),K(s!==r.ac)}}),1e3/ne)}},children:"Run"}),Object(f.jsx)("button",{onClick:function(){""===E&&(le(),M(!0))},children:"Stop"}),Object(f.jsx)("button",{onClick:function(){if(""===E&&(clearInterval(oe.current),(!w||ce.current)&&!(Z||A>=100))){var e,t=a,r=A,n=d,o="",l=w,s=Object(i.a)(t),u=n.ac,T=b(t,r,n,o,l,ce.current);t=T.memory,r=T.ip,n=T.registers,e=T.halt,o=T.output,l=T.waitingForInput,ce.current&&(ce.current=null),(e||r>=100)&&(clearInterval(oe.current),oe.current=null),r>=100&&(r=99),O(r),h(n),c(t),L(o),k(l),M(e);for(var m=[],p=0;p<t.length;p++)s[p]!==t[p]&&m.push(p);J(m),K(u!==n.ac)}},children:"Step"})]}),Object(f.jsxs)("main",{children:[Object(f.jsx)(s.a,{height:"90vh",width:"45vw",language:"lmc",theme:"vs-dark",defaultValue:g,beforeMount:D,onMount:function(t,r){e.current=t}}),Object(f.jsxs)("div",{className:"monitor",children:[Object(f.jsxs)("div",{className:"forms",children:[Object(f.jsxs)("form",{onSubmit:function(e){ce.current=F.substring(0,3),C(""),e.preventDefault()},className:"input-form",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",children:[Object(f.jsx)("label",{htmlFor:"ioinput",className:w?"green-border":"",children:"Input"}),Object(f.jsx)("input",{type:"text",name:"ioinput",value:F,onChange:function(e){C(e.target.value)}})]}),Object(f.jsxs)("form",{onSubmit:function(e){var t=parseInt(_)||60;t<=0&&(t=60),ae(t),e.preventDefault()},children:[Object(f.jsxs)("label",{htmlFor:"runspeed",children:["Speed (",ne,"Hz)"]}),Object(f.jsx)("input",{type:"number",name:"runspeed",value:_,onChange:function(e){ee(e.target.value)}})]}),Object(f.jsxs)("form",{children:[Object(f.jsx)("label",{htmlFor:"selectprogram",children:"Example"}),Object(f.jsx)("select",{onChange:function(t){e.current.setValue(j[t.target.value])},children:Object(f.jsx)(f.Fragment,{children:Object.keys(j).map((function(e){return Object(f.jsx)("option",{value:e,children:e},e)}))})})]})]}),Object(f.jsxs)("div",{className:"mem-reg-container",children:[Object(f.jsxs)("div",{className:"memory",children:[Object(f.jsx)("h2",{children:"Memory"}),Object(f.jsx)(f.Fragment,{children:function(){for(var e=[],t=0;t<a.length;t+=10){var r=a.slice(t,t+10);e.push(r)}return e.map((function(e,t){return Object(f.jsxs)("div",{className:"memory-row",children:[Object(f.jsxs)("p",{className:"memory-item",children:[10*t,": "]}),Object(f.jsx)(f.Fragment,{children:e.map((function(e,r){return Object(f.jsx)("p",{className:"memory-item ".concat(ie(10*t+r===A,Z)," ").concat(W.includes(10*t+r)?"yellow-border":""),children:e},"item"+10*t+r)}))})]},"memory"+t)}))}()})]}),Object(f.jsxs)("div",{className:"registers",children:[Object(f.jsx)("h2",{children:"Registers"}),Object(f.jsx)(f.Fragment,{children:function(){var e={pc:"Program Counter",ir:"Instruction",ar:"Address",ac:"Accumulator"};return Object.entries(d).map((function(t){var r=Object(l.a)(t,2),n=r[0],a=r[1];return Object(f.jsxs)("p",{style:{minWidth:e[n].length+2+3+"ch"},className:"register ".concat(ie("pc"===n,Z)," ").concat("ac"===n&&Y?"yellow-border":""),children:[e[n],": ",a]},n)}))}()})]})]}),Object(f.jsxs)("div",{className:"output-box",children:[Object(f.jsx)("h2",{children:"Output"}),Object(f.jsx)("p",{className:"output ".concat(""!==E?"error-output":""),children:""===E?v:E})]})]})]})]})};o.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(S,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.524a4b4c.chunk.js.map