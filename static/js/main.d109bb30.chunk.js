(this.webpackJsonplmc=this.webpackJsonplmc||[]).push([[0],{15:function(e,t,r){},16:function(e,t,r){},20:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(8),l=r.n(a),i=(r(15),r(7)),u=r(3),o=(r(16),r(10)),s=r(9),j=["LDA","STA","LOA","ADD","SUB","INP","OUT","OTC","HLT","BRZ","BRP","BRA","DAT"],b=["INP","OUT","OTC","HLT"],p={INP:901,OUT:902,OTC:912,HLT:0},m={LDA:"5",STA:"3",LOA:"4",ADD:"1",SUB:"2",BRZ:"7",BRP:"8",BRA:"6",DAT:""},f=function(e){for(var t=new Array(100).fill(0),r=e.split(/\r?\n/).filter((function(e){return 0!==e.length})).map((function(e,t){return e.replace(/\/\/.*?$/,"").split(/\s+/).filter((function(e){return 0!==e.length})).map((function(e){return function(e,t){return isNaN(e)||parseInt(e)!==parseFloat(e)?j.includes(e)?{type:"instruction",value:e,line:t}:e.match(/^[A-Z][A-Z0-9]+$/)?{type:"label",value:e,line:t}:{type:"invalid",value:e,line:t}:{type:"int",value:parseInt(e),line:t}}(e.toUpperCase(),t+1)}))})).filter((function(e){return 0!==e.length})),n={},c=0,a=0;a<r.length;a++){var l=r[a];"label"===l[0].type&&(n[l[0].value]=c,r[a]=l=l.slice(1)),c+=l.filter((function(e){return"instruction"===e.type})).length}var i,u=(r=r.filter((function(e){return 0!==e.length}))).flat(),o=Object(s.a)(u);try{for(o.s();!(i=o.n()).done;){var f=i.value;if("invalid"===f.type)return{memory:new Array(100).fill(0),error:"Unexpected token ".concat(f.value),errorLoc:f}}}catch(S){o.e(S)}finally{o.f()}for(var d=0,O=0;O<u.length;O++){var h=u[O];if("instruction"!==h.type)return{memory:new Array(100).fill(0),error:"Expected instruction, got ".concat(h.value),errorLoc:h};var v=h.value;if(b.includes(v))t[d]=p[v],d++;else{var g=m[v],y=u[O+1],x=g;if("int"===y.type)"DAT"===v?x=y.value.toString():x+=y.value.toString().padStart(2,"0");else{if("label"!==y.type)return{memory:new Array(100).fill(0),error:"Expected value, got ".concat(y.value),errorLoc:h};if(!(y.value in n))return{memory:new Array(100).fill(0),error:"Label ".concat(y.value," is not bound"),errorLoc:h};"DAT"===v?x=n[y.value].toString():x+=n[y.value].toString().padStart(2,"0")}if(x.length>3)return{memory:new Array(100).fill(0),error:"Values cannot exceed 3 digits (got ".concat(x,")"),errorLoc:h};t[d]=parseInt(x),d++,O++}if(d>99)return{memory:new Array(100).fill(0),error:"Exceeded memory capacity of 100 @ ".concat(h.value),errorLoc:h}}return{memory:t,error:null,errorLoc:null}},d=function(e,t,r,n,c,a){r.pc=t;var l=e[r.pc++].toString().padStart(3,"0"),i=parseInt(l[0]),u=10*parseInt(l[1])+parseInt(l[2]);r.ir=i,r.ar=u;var o=!1,s=!1;switch(c&&a&&(r.ac=parseInt(a)),i){case 0:o=!0;break;case 1:r.ac=r.ac+e[u];break;case 2:r.ac=r.ac-e[u];break;case 3:e[u]=r.ac;break;case 4:var j=r.ac,b=u+j>=100?99:u+j;r.ac=e[b];break;case 5:r.ac=e[u];break;case 6:r.pc=u;break;case 7:0===r.ac&&(r.pc=u);break;case 8:r.ac>=0&&(r.pc=u);break;case 9:1===u?s=!0:2===u?n+=r.ac+" ":12===u&&(n+=String.fromCharCode(r.ac))}return{memory:e,ip:r.pc,registers:r,output:n,halt:o,waitingForInput:s}},O=r(2),h=["// Input two numbers, sum them, and output the result","        INP","        STA FIRST","        INP","        ADD FIRST","        OUT","        HLT","FIRST   DAT 0"].join("\n");var v=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(Array(100).fill(0)),r=Object(u.a)(t,2),c=r[0],a=r[1],l=Object(n.useState)(0),s=Object(u.a)(l,2),j=s[0],b=s[1],p=Object(n.useState)({pc:0,ir:0,ar:0,ac:0}),m=Object(u.a)(p,2),v=m[0],g=m[1],y=Object(n.useState)(""),x=Object(u.a)(y,2),S=x[0],A=x[1],I=Object(n.useState)(""),N=Object(u.a)(I,2),T=N[0],w=N[1],C=Object(n.useState)(""),L=Object(u.a)(C,2),k=L[0],D=L[1],R=Object(n.useState)(!1),F=Object(u.a)(R,2),B=F[0],P=F[1],U=Object(n.useState)(!1),H=Object(u.a)(U,2),M=H[0],E=H[1],Z=Object(n.useState)([]),V=Object(u.a)(Z,2),z=V[0],J=V[1],$=Object(n.useState)(!1),W=Object(u.a)($,2),q=W[0],G=W[1],K=Object(n.useState)(""),Q=Object(u.a)(K,2),X=Q[0],Y=Q[1],_=Object(n.useState)(60),ee=Object(u.a)(_,2),te=ee[0],re=ee[1],ne=Object(n.useRef)(null),ce=Object(n.useRef)(null),ae=function(e,t){return e?t?"red-border":"green-border":""},le=function(){clearInterval(ce.current)};return Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)("h1",{className:"title",children:"Little Man Computer"}),Object(O.jsxs)("div",{className:"buttons",children:[Object(O.jsx)("button",{onClick:function(){le(),function(){var t=f(e.current.getValue());t.error?w("[".concat(t.errorLoc.line,"]: ").concat(t.error)):(a(t.memory),w(""))}(),b(0),g({pc:0,ir:0,ar:0,ac:0}),A(""),P(!1),E(!1),J([]),G(!1)},children:"Assemble To RAM (reset)"}),Object(O.jsx)("button",{onClick:function(){if(""===T){var e=c,t=0,r={pc:0,ir:0,ar:0,ac:0},n=!1,l="",u=!1;ce.current=setInterval((function(){if(!u||ne.current){var c=Object(i.a)(e),o=r.ac,s=d(e,t,r,l,u,ne.current);e=s.memory,t=s.ip,r=s.registers,n=s.halt,l=s.output,u=s.waitingForInput,ne.current&&(ne.current=null),(n||t>=100)&&(clearInterval(ce.current),ce.current=null),t>=100&&(t=99),b(t),g(r),a(e),A(l),P(u),E(n);for(var j=[],p=0;p<e.length;p++)c[p]!==e[p]&&j.push(p);J(j),G(o!==r.ac)}}),1e3/te)}},children:"Run"}),Object(O.jsx)("button",{onClick:function(){""===T&&(le(),E(!0))},children:"Stop"}),Object(O.jsx)("button",{onClick:function(){if(""===T&&(clearInterval(ce.current),(!B||ne.current)&&!(M||j>=100))){var e,t=c,r=j,n=v,l="",u=B,o=Object(i.a)(t),s=n.ac,p=d(t,r,n,l,u,ne.current);t=p.memory,r=p.ip,n=p.registers,e=p.halt,l=p.output,u=p.waitingForInput,ne.current&&(ne.current=null),(e||r>=100)&&(clearInterval(ce.current),ce.current=null),r>=100&&(r=99),b(r),g(n),a(t),A(l),P(u),E(e);for(var m=[],f=0;f<t.length;f++)o[f]!==t[f]&&m.push(f);J(m),G(s!==n.ac)}},children:"Step"})]}),Object(O.jsxs)("main",{children:[Object(O.jsx)(o.a,{height:"90vh",width:"45vw",theme:"vs-dark",defaultValue:h,onMount:function(t,r){e.current=t}}),Object(O.jsxs)("div",{className:"monitor",children:[Object(O.jsxs)("div",{className:"forms",children:[Object(O.jsxs)("form",{onSubmit:function(e){ne.current=k,D(""),e.preventDefault()},className:"input-form",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",children:[Object(O.jsx)("label",{htmlFor:"ioinput",className:B?"green-border":"",children:"Input"}),Object(O.jsx)("input",{type:"text",name:"ioinput",value:k,onChange:function(e){D(e.target.value)}})]}),Object(O.jsxs)("form",{onSubmit:function(e){var t=parseInt(X)||60;t<=0&&(t=60),Y(""),re(t),e.preventDefault()},children:[Object(O.jsxs)("label",{htmlFor:"runspeed",children:["Speed (Current: ",te,"Hz)"]}),Object(O.jsx)("input",{type:"number",name:"runspeed",value:X,onChange:function(e){Y(e.target.value)}})]})]}),Object(O.jsxs)("div",{className:"mem-reg-container",children:[Object(O.jsxs)("div",{className:"memory",children:[Object(O.jsx)("h2",{children:"Memory"}),Object(O.jsx)(O.Fragment,{children:function(){for(var e=[],t=0;t<c.length;t+=10){var r=c.slice(t,t+10);e.push(r)}return e.map((function(e,t){return Object(O.jsxs)("div",{className:"memory-row",children:[Object(O.jsxs)("p",{className:"memory-item",children:[10*t,": "]}),Object(O.jsx)(O.Fragment,{children:e.map((function(e,r){return Object(O.jsx)("p",{className:"memory-item ".concat(ae(10*t+r===j,M)," ").concat(z.includes(10*t+r)?"yellow-border":""),children:e},"item"+10*t+r)}))})]},"memory"+t)}))}()})]}),Object(O.jsxs)("div",{className:"registers",children:[Object(O.jsx)("h2",{children:"Registers"}),Object(O.jsx)(O.Fragment,{children:function(){var e={pc:"Program Counter",ir:"Instruction",ar:"Address",ac:"Accumulator"};return Object.entries(v).map((function(t){var r=Object(u.a)(t,2),n=r[0],c=r[1];return Object(O.jsxs)("p",{style:{minWidth:e[n].length+2+3+"ch"},className:"register ".concat(ae("pc"===n,M)," ").concat("ac"===n&&q?"yellow-border":""),children:[e[n],": ",c]},n)}))}()})]})]}),Object(O.jsxs)("div",{className:"output-box",children:[Object(O.jsx)("h2",{children:"Output"}),Object(O.jsx)("p",{className:"output ".concat(""!==T?"error-output":""),children:""===T?S:T})]})]})]})]})};l.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(v,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.d109bb30.chunk.js.map