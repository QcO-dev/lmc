(this.webpackJsonplmc=this.webpackJsonplmc||[]).push([[0],{15:function(e,t,r){},16:function(e,t,r){},20:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(8),i=r.n(a),o=(r(15),r(7)),u=r(3),l=(r(16),r(10)),s=r(9),m=["LDA","STA","LOA","ADD","SUB","INP","OUT","OTC","HLT","BRZ","BRP","BRA","DAT"],b=["INP","OUT","OTC","HLT"],j={INP:901,OUT:902,OTC:912,HLT:0},p={LDA:"5",STA:"3",LOA:"4",ADD:"1",SUB:"2",BRZ:"7",BRP:"8",BRA:"6",DAT:""},f=function(e){for(var t=new Array(100).fill(0),r=e.split(/\r?\n/).filter((function(e){return 0!==e.length})).map((function(e,t){return e.replace(/\/\/.*?$/,"").split(/\s+/).filter((function(e){return 0!==e.length})).map((function(e){return function(e,t){return isNaN(e)||parseInt(e)!==parseFloat(e)?m.includes(e)?{type:"instruction",value:e,line:t}:e.match(/^[A-Z][A-Z0-9]*$/)?{type:"label",value:e,line:t}:{type:"invalid",value:e,line:t}:{type:"int",value:parseInt(e),line:t}}(e.toUpperCase(),t+1)}))})).filter((function(e){return 0!==e.length})),n={},c=0,a=0;a<r.length;a++){var i=r[a];"label"===i[0].type&&(n[i[0].value]=c,r[a]=i=i.slice(1)),c+=i.filter((function(e){return"instruction"===e.type})).length}var o,u=(r=r.filter((function(e){return 0!==e.length}))).flat(),l=Object(s.a)(u);try{for(l.s();!(o=l.n()).done;){var f=o.value;if("invalid"===f.type)return{memory:new Array(100).fill(0),error:"Unexpected token ".concat(f.value),errorLoc:f}}}catch(A){l.e(A)}finally{l.f()}for(var d=0,O=0;O<u.length;O++){var h=u[O];if("instruction"!==h.type)return{memory:new Array(100).fill(0),error:"Expected instruction, got ".concat(h.value),errorLoc:h};var v=h.value;if(b.includes(v))t[d]=j[v],d++;else{var g=p[v],y=u[O+1],x=g;if("int"===y.type)"DAT"===v?x=y.value.toString():x+=y.value.toString().padStart(2,"0");else{if("label"!==y.type)return{memory:new Array(100).fill(0),error:"Expected value, got ".concat(y.value),errorLoc:h};if(!(y.value in n))return{memory:new Array(100).fill(0),error:"Label ".concat(y.value," is not bound"),errorLoc:h};"DAT"===v?x=n[y.value].toString():x+=n[y.value].toString().padStart(2,"0")}if(x.length>3)return{memory:new Array(100).fill(0),error:"Values cannot exceed 3 digits (got ".concat(x,")"),errorLoc:h};t[d]=parseInt(x),d++,O++}if(d>99)return{memory:new Array(100).fill(0),error:"Exceeded memory capacity of 100 @ ".concat(h.value),errorLoc:h}}return{memory:t,error:null,errorLoc:null}},d=function(e,t,r,n,c,a){r.pc=t;var i=e[r.pc++].toString().padStart(3,"0"),o=parseInt(i[0]),u=10*parseInt(i[1])+parseInt(i[2]);r.ir=o,r.ar=u;var l=!1,s=!1;switch(c&&a&&(r.ac=parseInt(a)),o){case 0:l=!0;break;case 1:r.ac=r.ac+e[u];break;case 2:r.ac=r.ac-e[u];break;case 3:e[u]=r.ac;break;case 4:var m=r.ac,b=u+m>=100?99:u+m;r.ac=e[b];break;case 5:r.ac=e[u];break;case 6:r.pc=u;break;case 7:0===r.ac&&(r.pc=u);break;case 8:r.ac>=0&&(r.pc=u);break;case 9:1===u?s=!0:2===u?n+=r.ac+" ":12===u&&(n+=String.fromCharCode(r.ac))}return{memory:e,ip:r.pc,registers:r,output:n,halt:l,waitingForInput:s}},O={defaultToken:"",keywords:["LDA","STA","LOA","ADD","SUB","INP","OUT","OTC","HLT","BRZ","BRP","BRA","DAT"],tokenizer:{root:[{include:"@whitespace"},[/[a-zA-Z][a-zA-Z0-9]*/,{cases:{"@keywords":"keyword","@default":"type.identifier"}}],[/\d+/,"number"]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\/.*$/,"comment"]]}},h={comments:{lineComment:"//"}},v=r(2),g=["// Input two numbers, sum them, and output the result","        INP","        STA FIRST","        INP","        ADD FIRST","        OUT","        HLT","FIRST   DAT 0"].join("\n"),y=function(e){e.languages.getLanguages().some((function(e){return"lmc"===e.id}))||(e.languages.register({id:"lmc"}),e.languages.setMonarchTokensProvider("lmc",O),e.languages.setLanguageConfiguration("lmc",h))};var x=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(Array(100).fill(0)),r=Object(u.a)(t,2),c=r[0],a=r[1],i=Object(n.useState)(0),s=Object(u.a)(i,2),m=s[0],b=s[1],j=Object(n.useState)({pc:0,ir:0,ar:0,ac:0}),p=Object(u.a)(j,2),O=p[0],h=p[1],x=Object(n.useState)(""),A=Object(u.a)(x,2),S=A[0],T=A[1],I=Object(n.useState)(""),w=Object(u.a)(I,2),N=w[0],k=w[1],L=Object(n.useState)(""),C=Object(u.a)(L,2),D=C[0],R=C[1],B=Object(n.useState)(!1),F=Object(u.a)(B,2),P=F[0],U=F[1],M=Object(n.useState)(!1),Z=Object(u.a)(M,2),H=Z[0],z=Z[1],E=Object(n.useState)([]),V=Object(u.a)(E,2),$=V[0],J=V[1],W=Object(n.useState)(!1),q=Object(u.a)(W,2),G=q[0],K=q[1],Q=Object(n.useState)(""),X=Object(u.a)(Q,2),Y=X[0],_=X[1],ee=Object(n.useState)(60),te=Object(u.a)(ee,2),re=te[0],ne=te[1],ce=Object(n.useRef)(null),ae=Object(n.useRef)(null),ie=function(e,t){return e?t?"red-border":"green-border":""},oe=function(){clearInterval(ae.current)};return Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)("h1",{className:"title",children:"Little Man Computer"}),Object(v.jsxs)("div",{className:"buttons",children:[Object(v.jsx)("button",{onClick:function(){oe(),function(){var t=f(e.current.getValue());t.error?k("[".concat(t.errorLoc.line,"]: ").concat(t.error)):(a(t.memory),k(""))}(),b(0),h({pc:0,ir:0,ar:0,ac:0}),T(""),U(!1),z(!1),J([]),K(!1)},children:"Assemble To RAM (reset)"}),Object(v.jsx)("button",{onClick:function(){if(""===N){var e=c,t=0,r={pc:0,ir:0,ar:0,ac:0},n=!1,i="",u=!1;ae.current=setInterval((function(){if(!u||ce.current){var c=Object(o.a)(e),l=r.ac,s=d(e,t,r,i,u,ce.current);e=s.memory,t=s.ip,r=s.registers,n=s.halt,i=s.output,u=s.waitingForInput,ce.current&&(ce.current=null),(n||t>=100)&&(clearInterval(ae.current),ae.current=null),t>=100&&(t=99),b(t),h(r),a(e),T(i),U(u),z(n);for(var m=[],j=0;j<e.length;j++)c[j]!==e[j]&&m.push(j);J(m),K(l!==r.ac)}}),1e3/re)}},children:"Run"}),Object(v.jsx)("button",{onClick:function(){""===N&&(oe(),z(!0))},children:"Stop"}),Object(v.jsx)("button",{onClick:function(){if(""===N&&(clearInterval(ae.current),(!P||ce.current)&&!(H||m>=100))){var e,t=c,r=m,n=O,i="",u=P,l=Object(o.a)(t),s=n.ac,j=d(t,r,n,i,u,ce.current);t=j.memory,r=j.ip,n=j.registers,e=j.halt,i=j.output,u=j.waitingForInput,ce.current&&(ce.current=null),(e||r>=100)&&(clearInterval(ae.current),ae.current=null),r>=100&&(r=99),b(r),h(n),a(t),T(i),U(u),z(e);for(var p=[],f=0;f<t.length;f++)l[f]!==t[f]&&p.push(f);J(p),K(s!==n.ac)}},children:"Step"})]}),Object(v.jsxs)("main",{children:[Object(v.jsx)(l.a,{height:"90vh",width:"45vw",language:"lmc",theme:"vs-dark",defaultValue:g,beforeMount:y,onMount:function(t,r){e.current=t}}),Object(v.jsxs)("div",{className:"monitor",children:[Object(v.jsxs)("div",{className:"forms",children:[Object(v.jsxs)("form",{onSubmit:function(e){ce.current=D,R(""),e.preventDefault()},className:"input-form",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",children:[Object(v.jsx)("label",{htmlFor:"ioinput",className:P?"green-border":"",children:"Input"}),Object(v.jsx)("input",{type:"text",name:"ioinput",value:D,onChange:function(e){R(e.target.value)}})]}),Object(v.jsxs)("form",{onSubmit:function(e){var t=parseInt(Y)||60;t<=0&&(t=60),_(""),ne(t),e.preventDefault()},children:[Object(v.jsxs)("label",{htmlFor:"runspeed",children:["Speed (Current: ",re,"Hz)"]}),Object(v.jsx)("input",{type:"number",name:"runspeed",value:Y,onChange:function(e){_(e.target.value)}})]})]}),Object(v.jsxs)("div",{className:"mem-reg-container",children:[Object(v.jsxs)("div",{className:"memory",children:[Object(v.jsx)("h2",{children:"Memory"}),Object(v.jsx)(v.Fragment,{children:function(){for(var e=[],t=0;t<c.length;t+=10){var r=c.slice(t,t+10);e.push(r)}return e.map((function(e,t){return Object(v.jsxs)("div",{className:"memory-row",children:[Object(v.jsxs)("p",{className:"memory-item",children:[10*t,": "]}),Object(v.jsx)(v.Fragment,{children:e.map((function(e,r){return Object(v.jsx)("p",{className:"memory-item ".concat(ie(10*t+r===m,H)," ").concat($.includes(10*t+r)?"yellow-border":""),children:e},"item"+10*t+r)}))})]},"memory"+t)}))}()})]}),Object(v.jsxs)("div",{className:"registers",children:[Object(v.jsx)("h2",{children:"Registers"}),Object(v.jsx)(v.Fragment,{children:function(){var e={pc:"Program Counter",ir:"Instruction",ar:"Address",ac:"Accumulator"};return Object.entries(O).map((function(t){var r=Object(u.a)(t,2),n=r[0],c=r[1];return Object(v.jsxs)("p",{style:{minWidth:e[n].length+2+3+"ch"},className:"register ".concat(ie("pc"===n,H)," ").concat("ac"===n&&G?"yellow-border":""),children:[e[n],": ",c]},n)}))}()})]})]}),Object(v.jsxs)("div",{className:"output-box",children:[Object(v.jsx)("h2",{children:"Output"}),Object(v.jsx)("p",{className:"output ".concat(""!==N?"error-output":""),children:""===N?S:N})]})]})]})]})};i.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(x,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.d4a0e37b.chunk.js.map